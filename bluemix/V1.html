<html>
<body>
<h1>V1</h>

<svg width = "720", height = "1080">

</svg>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

<script> var nodes = JSON.parse({"Cookware and bakeware":[{"id":"56078b5dc55949.31873613","pid":"0","url":"https://www.google.com/#q=beef%20wellington&safe=off","time":"5829","token":"56078b57a81bc0.42887907","color":"91923f","depth":1},{"id":"56078b62c9db53.41419622","pid":"56078b5dc55949.31873613","url":"http://www.foodnetwork.com/recipes/tyler-florence/the-ultimate-beef-wellington-recipe2.html","time":"8147","token":"56078b57a81bc0.42887907","color":"91923f","depth":2},{"id":"56078b6ad93421.26646605","pid":"56078b62c9db53.41419622","url":"http://www.foodterms.com/encyclopedia/egg-wash/index.html","time":"7823","token":"56078b57a81bc0.42887907","color":"91923f","depth":3},{"id":"56078b72e386e0.21907420","pid":"56078b6ad93421.26646605","url":"http://www.foodnetwork.com/recipes/tyler-florence/the-ultimate-beef-wellington-recipe2.html","time":"8840","token":"56078b57a81bc0.42887907","color":"91923f","depth":4},{"id":"56078b80f17ba0.66568219","pid":"56078b5dc55949.31873613","url":"http://www.chowhound.com/recipes/classic-beef-wellington-29112","time":"17391","token":"56078b57a81bc0.42887907","color":"91923f","depth":2}],"Mario Testino, Jennifer Aniston":[{"id":"56078b9208f064.79831927","pid":"0","url":"https://www.google.com/#q=Brad%20pitt&safe=off","time":"9198","token":"56078b57a81bc0.42887907","color":"91923f","depth":1},{"id":"56078b9c0f7250.81995706","pid":"56078b9208f064.79831927","url":"http://www.vanityfair.com/news/2005/09/aniston200509","time":"10327","token":"56078b57a81bc0.42887907","color":"91923f","depth":2},{"id":"56078bad1a2980.23006296","pid":"56078b9208f064.79831927","url":"https://en.wikipedia.org/wiki/Brad_Pitt","time":"3027","token":"56078b57a81bc0.42887907","color":"91923f","depth":2},{"id":"56078bb023d288.79358643","pid":"56078bad1a2980.23006296","url":"http://www.aol.com/article/2015/09/25/farmer-complains-brad-pitt-film-is-scaring-his-chickens/21240920/","time":"0","token":"56078b57a81bc0.42887907","color":"91923f","depth":3},{"id":"56078bb3293335.18253642","pid":"56078bb023d288.79358643","url":"http://www.aol.com/article/2015/09/25/farmer-complains-brad-pitt-film-is-scaring-his-chickens/21240920/","time":"4938","token":"56078b57a81bc0.42887907","color":"91923f","depth":4},{"id":"56078bc77fa5b4.01835881","pid":"56078bad1a2980.23006296","url":"https://en.wikipedia.org/wiki/A_River_Runs_Through_It_(film)","time":"13889","token":"56078b57a81bc0.42887907","color":"91923f","depth":3},{"id":"56078bd5857088.49726799","pid":"56078bc77fa5b4.01835881","url":"https://en.wikipedia.org/wiki/Tom_Skerritt","time":"5099","token":"56078b57a81bc0.42887907","color":"91923f","depth":4},{"id":"56078bda8b3799.24270840","pid":"56078bd5857088.49726799","url":"https://en.wikipedia.org/wiki/Fuzz_(film)","time":"4207","token":"56078b57a81bc0.42887907","color":"91923f","depth":5},{"id":"56078bde8fa846.53650743","pid":"56078bda8b3799.24270840","url":"https://en.wikipedia.org/wiki/Tom_Skerritt","time":"4623","token":"56078b57a81bc0.42887907","color":"91923f","depth":6},{"id":"56078be394ab40.65967972","pid":"56078bde8fa846.53650743","url":"https://en.wikipedia.org/wiki/Chicago_Hope","time":"16636","token":"56078b57a81bc0.42887907","color":"91923f","depth":7},{"id":"56078bf39c1b84.15506389","pid":"56078be394ab40.65967972","url":"https://en.wikipedia.org/wiki/New_Zealand","time":"18784","token":"56078b57a81bc0.42887907","color":"91923f","depth":8},{"id":"56078c06a568d2.62216182","pid":"56078bf39c1b84.15506389","url":"https://en.wikipedia.org/wiki/New_Zealand_Parliament","time":"0","token":"56078b57a81bc0.42887907","color":"91923f","depth":9}]});
</script>

<script>

var nodesPropertiesArr = nodes.getOwnPropertyNames();
var numRootNodes = nodesPropertiesArr.length();
var dataIn = [][];
for (p = 0; p < numRootNodes; p ++) {
    dataIn[p] = nodes.nodesPropertiesArr[p];
}
</script>

<script>
var maxRadius = 540 /((2 * dataIn.length) + 1);
var depthCounts = [][];
var maxDepth = [];
for(y = 0; y < numRootNodes; y++) {
    maxDepth[y] = 0;
    for (l = 0; l < dataIn.length; l++) {
        if (dataIn[l].depth > maxDepth) {
            maxDepth[y] = dataIn[l].depth;
        }
    }
}
</script>

<script>
for(t = 0; t < numRootNodes; t++){
    for(o = 1; o <= maxDepth; o ++) {
        depthCounts[o] = 0;
        for(u = 0; u < dataIn[t].length; u ++) {
            if (dataIn[t][u].depth == o) {
                depthCounts[o] ++;
            }
        }
    }
}
</script>

<script>
var svg = d3.select("svg")
            .attr("width", 1080 * numRootNodes);
var circle = svg.selectAll("circle")
            .data(dataIn)
            .enter()
            .append("circle")
            .attr("cy", function(d) {return  - d[i].depth * 2 * maxRadius * sin((i * 6.14) / (depthCounts[d[i].depth])) + 540 } )
            .attr("cx", function(d) {return  d[i].depth * 2 * maxRadius * cos((i * 6.14) / (depthCounts[d[i].depth])) + ((i + 1) * 540) } )
            .attr("r", 0);
circle.transition().attr("r", function(d) {return  maxRadius * (1 - Math.exp( - d[i].time /50))} );
</script>

<script>
var lines = [];
var linesIndex = 0;
for(n = 0; n < numRootNodes; n++){
    for (s = 0; s < dataIn[n].length; s++) {
        for (a = 0; a < dataIn[n].length; a++) {
            if (dataIn[n][s].cid == dataIn[n][a].pid) {
                lines[linesIndex] = {x1: dataIn[n][s].depth * 2 * maxRadius * cos((s * 6.14) / (depthCounts[dataIn[n][s].depth])) + ((i + 1) * 540), y1: dataIn[n][s].time * 25, x2:  dataIn[n][a].depth * 2 * maxRadius * cos((i * 6.14) / (depthCounts[dataIn[n][a].depth])) + ((i + 1) * 540), y2: dataIn[n][a].time * 25};
                linesIndex ++;
            }
        }
    }
}


var line = svg.selectAll("line")
            .data(lines)
            .enter()
            .append("line")
            .attr("x1", function(d) {return d[i].x1})
            .attr("y1", function(d) {return d[i].y1})
            .attr("x2", function(d) {return d[i].x2})
            .attr("y2", function(d) {return d[i].y2})
            .style("stroke-width", 2)
            .style("stroke", "black");

var text = svg.selectAll("text")
            .data(dataIn)
            .enter()
            .append("text")
            .attr("x", function(d) {return d[i].depth * 2 * maxRadius * cos((i * 6.14) / (depthCounts[d[i].depth])) + ((i + 1) * 540)})
            .attr("y", function(d) {return (- d[i].depth * 2 * maxRadius * sin((i * 6.14) / (depthCounts[d.depth])) + 540) + 12 + (maxRadius * (1 - Math.exp( - d.time /50)))})
            .attr("font-size", 12)
            .attr("dx", function(d) {return  - (d.name.length * 2)})
            .text(function(d) {return d[i].name});

</script>
</body>
</html>
